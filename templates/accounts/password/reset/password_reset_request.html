{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="center-card">
    <div class="card auth-card">
        <h1 class="card__title">Сброс пароля</h1>
        
        {% if not code_sent %}
        <p class="muted">
            Для сброса пароля мы отправим 6-значный код на email вашего аккаунта:
        </p>
        
        <div class="alert alert-info">
            <i class="bi bi-envelope"></i>
            <strong>Email:</strong> {{ user_email }}
        </div>
        
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="send_code" value="1">
            
            <div class="field" style="margin-top: 24px;">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-envelope"></i> Отправить код на почту
                </button>
            </div>
            
            <div class="text-center" style="margin: 16px 0;">
                <a href="{% url 'profile' %}" class="btn btn-outline-secondary w-100">
                    <i class="bi bi-arrow-left"></i> Вернуться в профиль
                </a>
            </div>
        </form>
        
        {% else %}
        <p class="muted">
            Мы отправили 6-значный код на <strong>{{ user_email }}</strong>.
            Введите его ниже.
        </p>
        
        <div class="alert alert-warning">
            <i class="bi bi-clock"></i> 
            Код действителен 2 минуты
        </div>
        
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="verify_code" value="1">
            
            <div class="field">
                <label for="id_code" class="form-label">6-значный код</label>
                <input type="text" 
                       name="code" 
                       id="id_code" 
                       class="form-control" 
                       maxlength="6" 
                       minlength="6"
                       required
                       style="letter-spacing: 3px; text-align: center; font-size: 20px; font-weight: bold;"
                       placeholder="000000"
                       autocomplete="off">
                <small class="muted" style="text-align: center; display: block; margin-top: 8px;">
                    Введите 6 цифр из письма
                </small>
            </div>
            
            <div class="field" style="margin-top: 24px;">
                <button type="submit" class="btn btn-primary w-100">
                    <i class="bi bi-check-circle"></i> Подтвердить код
                </button>
            </div>
            
            <div class="text-center" style="margin: 16px 0;">
                <a href="{% url 'profile' %}" class="btn btn-outline-secondary w-100">
                    Отмена
                </a>
            </div>
        </form>
        
        <div class="text-center">
            <form method="post" style="margin-top: 16px;">
                {% csrf_token %}
                <input type="hidden" name="send_code" value="1">
                <button type="submit" class="btn btn-outline-primary">
                    <i class="bi bi-arrow-clockwise"></i> Отправить новый код
                </button>
            </form>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}