{% extends 'employees/admin/admin_base.html' %}

{% block title %}–í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º{% endblock %}
{% block page_title %}üé¨ –í–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç ({{ total_count }}){% endblock %}

{% block content %}
<div class="content-box">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0;">–°–ø–∏—Å–æ–∫ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h2>
        <a href="{% url 'admin_content_add' %}" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç</a>
    </div>

    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
        <form method="get" style="display: flex; gap: 10px; align-items: center;">
            <input type="text" name="search" value="{{ search_query }}" 
                   placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é..." 
                   style="flex: 1; padding: 10px; border: 1px solid #e2e8f0; border-radius: 4px;">
            <button type="submit" class="btn" style="background: #4299e1;">üîç –ü–æ–∏—Å–∫</button>
            {% if search_query %}
            <a href="{% url 'admin_content_list' %}" class="btn" style="background: #a0aec0;">‚ùå –û—á–∏—Å—Ç–∏—Ç—å</a>
            {% endif %}
        </form>
    </div>

    <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
        <a href="?search={{ search_query }}&type=all" 
           class="btn {% if not current_type or current_type == 'all' %}active{% endif %}" 
           style="background: #4a5568;">–í—Å–µ</a>
        <a href="?search={{ search_query }}&type=movie" 
           class="btn {% if current_type == 'movie' %}active{% endif %}" 
           style="background: #4299e1;">–§–∏–ª—å–º—ã</a>
        <a href="?search={{ search_query }}&type=series" 
           class="btn {% if current_type == 'series' %}active{% endif %}" 
           style="background: #ed8936;">–°–µ—Ä–∏–∞–ª—ã</a>
        <a href="?search={{ search_query }}&free=true" 
           class="btn {% if current_free == 'true' %}active{% endif %}" 
           style="background: #48bb78;">–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ</a>
        <a href="?search={{ search_query }}&free=false" 
           class="btn {% if current_free == 'false' %}active{% endif %}" 
           style="background: #805ad5;">–ü–ª–∞—Ç–Ω—ã–µ</a>
    </div>
    
    {% if content_list %}
    <table>
        <thead>
            <tr>
                <th>–ü–æ—Å—Ç–µ—Ä</th>
                <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                <th>–¢–∏–ø</th>
                <th>–ì–æ–¥</th>
                <th>–ñ–∞–Ω—Ä—ã</th>
                <th>–¶–µ–Ω–∞</th>
                <th>–î–æ–±–∞–≤–ª–µ–Ω</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for content in content_list %}
            <tr>
                <td>
                    {% if content.cover_url %}
                    <img src="{{ content.cover_url }}" alt="–ü–æ—Å—Ç–µ—Ä" 
                         style="width: 60px; height: 80px; object-fit: cover; border-radius: 4px;">
                    {% else %}
                    <div style="width: 60px; height: 80px; background: #e2e8f0; border-radius: 4px; display: flex; align-items: center; justify-content: center;">
                        <span style="color: #a0aec0; font-size: 12px;">–ù–µ—Ç</span>
                    </div>
                    {% endif %}
                </td>
                <td>
                    <strong>{{ content.title }}</strong>
                    {% if content.description %}
                    <div style="font-size: 12px; color: #718096; margin-top: 4px;">
                        {{ content.description|truncatechars:60 }}
                    </div>
                    {% endif %}
                </td>
                <td>
                    {% if content.type == 'movie' %}
                    <span class="badge badge-movie">–§–∏–ª—å–º</span>
                    {% else %}
                    <span class="badge badge-series">–°–µ—Ä–∏–∞–ª</span>
                    {% endif %}
                </td>
                <td>{{ content.release_year }}</td>
                <td>
                    {% if content.genres %}
                    {{ content.genres|truncatechars:30 }}
                    {% else %}
                    <span style="color: #a0aec0;">‚Äî</span>
                    {% endif %}
                </td>
                <td>
                    {% if content.is_free %}
                    <span class="badge badge-free">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                    {% else %}
                    <span class="badge badge-paid">{{ content.price }} ‚ÇΩ</span>
                    {% endif %}
                </td>
                <td>{{ content.created_at|date:"d.m.Y" }}</td>
                <td class="actions">
                    <a href="{% url 'admin_content_edit' content.id %}" class="btn" style="padding: 4px 8px; font-size: 12px;">‚úèÔ∏è</a>
                    <form method="post" action="{% url 'admin_content_delete' content.id %}" 
                          style="display: inline; margin-left: 5px;">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger" 
                                style="padding: 4px 8px; font-size: 12px;"
                                onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç ¬´{{ content.title }}¬ª?')">
                            üóëÔ∏è
                        </button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    
    {% if search_query %}
    <div style="margin-top: 20px; padding: 10px; background: #f0fff4; border: 1px solid #9ae6b4; border-radius: 4px;">
        –ù–∞–π–¥–µ–Ω–æ {{ total_count }} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É: "<strong>{{ search_query }}</strong>"
    </div>
    {% endif %}

    {% else %}
    <div style="text-align: center; padding: 40px; color: #718096;">
        {% if search_query %}
        <p>–ü–æ –∑–∞–ø—Ä–æ—Å—É "{{ search_query }}" –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
        <a href="{% url 'admin_content_list' %}" class="btn" style="margin-top: 15px;">–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ</a>
        {% else %}
        <p>–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</p>
        <a href="{% url 'admin_content_add' %}" class="btn btn-success" style="margin-top: 15px;">–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç</a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}